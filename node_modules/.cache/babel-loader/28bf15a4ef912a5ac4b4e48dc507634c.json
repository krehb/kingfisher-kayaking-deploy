{"ast":null,"code":"/* Copyright (c) 2012-2014 LevelUP contributors\n * See list at <https://github.com/rvagg/node-levelup#contributing>\n * MIT License <https://github.com/rvagg/node-levelup/blob/master/LICENSE.md>\n */\n// NOTE: we are fixed to readable-stream@1.0.x for now\n// for pure Streams2 across Node versions\nvar Readable = require('readable-stream').Readable,\n    inherits = require('util').inherits,\n    extend = require('xtend'),\n    EncodingError = require('./errors').EncodingError,\n    util = require('./util'),\n    defaultOptions = {\n  keys: true,\n  values: true\n},\n    makeKeyValueData = function (key, value) {\n  return {\n    key: util.decodeKey(key, this._options),\n    value: util.decodeValue(value, this._options)\n  };\n},\n    makeKeyData = function (key) {\n  return util.decodeKey(key, this._options);\n},\n    makeValueData = function (_, value) {\n  return util.decodeValue(value, this._options);\n},\n    makeNoData = function () {\n  return null;\n};\n\nfunction ReadStream(options, db, iteratorFactory) {\n  if (!(this instanceof ReadStream)) return new ReadStream(options, db, iteratorFactory);\n  Readable.call(this, {\n    objectMode: true,\n    highWaterMark: options.highWaterMark\n  }); // purely to keep `db` around until we're done so it's not GCed if the user doesn't keep a ref\n\n  this._db = db;\n  options = this._options = extend(defaultOptions, options);\n  this._keyEncoding = options.keyEncoding || options.encoding;\n  this._valueEncoding = options.valueEncoding || options.encoding;\n  if (typeof this._options.start != 'undefined') this._options.start = util.encodeKey(this._options.start, this._options);\n  if (typeof this._options.end != 'undefined') this._options.end = util.encodeKey(this._options.end, this._options);\n  if (typeof this._options.limit != 'number') this._options.limit = -1;\n  this._options.keyAsBuffer = util.isKeyAsBuffer(this._options);\n  this._options.valueAsBuffer = util.isValueAsBuffer(this._options);\n  this._makeData = this._options.keys && this._options.values ? makeKeyValueData : this._options.keys ? makeKeyData : this._options.values ? makeValueData : makeNoData;\n  var self = this;\n\n  if (!this._db.isOpen()) {\n    this._db.once('ready', function () {\n      if (!self._destroyed) {\n        self._iterator = iteratorFactory(self._options);\n      }\n    });\n  } else this._iterator = iteratorFactory(this._options);\n}\n\ninherits(ReadStream, Readable);\n\nReadStream.prototype._read = function read() {\n  var self = this;\n\n  if (!self._db.isOpen()) {\n    return self._db.once('ready', function () {\n      read.call(self);\n    });\n  }\n\n  if (self._destroyed) return;\n\n  self._iterator.next(function (err, key, value) {\n    if (err || key === undefined && value === undefined) {\n      if (!err && !self._destroyed) self.push(null);\n      return self._cleanup(err);\n    }\n\n    try {\n      value = self._makeData(key, value);\n    } catch (e) {\n      return self._cleanup(new EncodingError(e));\n    }\n\n    if (!self._destroyed) self.push(value);\n  });\n};\n\nReadStream.prototype._cleanup = function (err) {\n  if (this._destroyed) return;\n  this._destroyed = true;\n  var self = this;\n  if (err) self.emit('error', err);\n\n  if (self._iterator) {\n    self._iterator.end(function () {\n      self._iterator = null;\n      self.emit('close');\n    });\n  } else {\n    self.emit('close');\n  }\n};\n\nReadStream.prototype.destroy = function () {\n  this._cleanup();\n};\n\nReadStream.prototype.toString = function () {\n  return 'LevelUP.ReadStream';\n};\n\nmodule.exports = ReadStream;","map":{"version":3,"sources":["C:/Users/jdk17/Desktop/KingFisher/kingfisher-kayaking/node_modules/levelup/lib/read-stream.js"],"names":["Readable","require","inherits","extend","EncodingError","util","defaultOptions","keys","values","makeKeyValueData","key","value","decodeKey","_options","decodeValue","makeKeyData","makeValueData","_","makeNoData","ReadStream","options","db","iteratorFactory","call","objectMode","highWaterMark","_db","_keyEncoding","keyEncoding","encoding","_valueEncoding","valueEncoding","start","encodeKey","end","limit","keyAsBuffer","isKeyAsBuffer","valueAsBuffer","isValueAsBuffer","_makeData","self","isOpen","once","_destroyed","_iterator","prototype","_read","read","next","err","undefined","push","_cleanup","e","emit","destroy","toString","module","exports"],"mappings":"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","sourcesContent":["/* Copyright (c) 2012-2014 LevelUP contributors\n * See list at <https://github.com/rvagg/node-levelup#contributing>\n * MIT License <https://github.com/rvagg/node-levelup/blob/master/LICENSE.md>\n */\n\n// NOTE: we are fixed to readable-stream@1.0.x for now\n// for pure Streams2 across Node versions\nvar Readable      = require('readable-stream').Readable\n  , inherits      = require('util').inherits\n  , extend        = require('xtend')\n  , EncodingError = require('./errors').EncodingError\n  , util          = require('./util')\n\n  , defaultOptions = { keys: true, values: true }\n\n  , makeKeyValueData = function (key, value) {\n      return {\n          key: util.decodeKey(key, this._options)\n        , value: util.decodeValue(value, this._options)\n      }\n    }\n  , makeKeyData = function (key) {\n      return util.decodeKey(key, this._options)\n    }\n  , makeValueData = function (_, value) {\n      return util.decodeValue(value, this._options)\n    }\n  , makeNoData = function () { return null }\n\nfunction ReadStream (options, db, iteratorFactory) {\n  if (!(this instanceof ReadStream))\n    return new ReadStream(options, db, iteratorFactory)\n\n  Readable.call(this, { objectMode: true, highWaterMark: options.highWaterMark })\n\n  // purely to keep `db` around until we're done so it's not GCed if the user doesn't keep a ref\n  this._db = db\n\n  options = this._options = extend(defaultOptions, options)\n\n  this._keyEncoding   = options.keyEncoding   || options.encoding\n  this._valueEncoding = options.valueEncoding || options.encoding\n\n  if (typeof this._options.start != 'undefined')\n    this._options.start = util.encodeKey(this._options.start, this._options)\n  if (typeof this._options.end != 'undefined')\n    this._options.end = util.encodeKey(this._options.end, this._options)\n  if (typeof this._options.limit != 'number')\n    this._options.limit = -1\n\n  this._options.keyAsBuffer   = util.isKeyAsBuffer(this._options)\n\n  this._options.valueAsBuffer = util.isValueAsBuffer(this._options)\n\n  this._makeData = this._options.keys && this._options.values\n    ? makeKeyValueData : this._options.keys\n      ? makeKeyData : this._options.values\n        ? makeValueData : makeNoData\n\n  var self = this\n  if (!this._db.isOpen()) {\n    this._db.once('ready', function () {\n      if (!self._destroyed) {\n        self._iterator = iteratorFactory(self._options)\n      }\n    })\n  } else\n    this._iterator = iteratorFactory(this._options)\n}\n\ninherits(ReadStream, Readable)\n\nReadStream.prototype._read = function read () {\n  var self = this\n  if (!self._db.isOpen()) {\n    return self._db.once('ready', function () { read.call(self) })\n  }\n  if (self._destroyed)\n    return\n \n  self._iterator.next(function(err, key, value) {\n    if (err || (key === undefined && value === undefined)) {\n      if (!err && !self._destroyed)\n        self.push(null)\n      return self._cleanup(err)\n    }\n\n    try {\n      value = self._makeData(key, value)\n    } catch (e) {\n      return self._cleanup(new EncodingError(e))\n    }\n    if (!self._destroyed)\n      self.push(value)\n  })\n}\n\nReadStream.prototype._cleanup = function (err) {\n  if (this._destroyed)\n    return\n\n  this._destroyed = true\n\n  var self = this\n  if (err)\n    self.emit('error', err)\n\n  if (self._iterator) {\n    self._iterator.end(function () {\n      self._iterator = null\n      self.emit('close')\n    })\n  } else {\n    self.emit('close')\n  }\n}\n\nReadStream.prototype.destroy = function () {\n  this._cleanup()\n}\n\nReadStream.prototype.toString = function () {\n  return 'LevelUP.ReadStream'\n}\n\nmodule.exports = ReadStream\n"]},"metadata":{},"sourceType":"script"}